<div class="filler"></div>

<div class="user-heading">
  <div class="user-heading-left">
    <h1 class="user-name"><%= @user.name.capitalize %>'s Page</h1>
    <h2 class="user-email"><%= @user.email %></h2>
    <% if myself?(@user.id) && logged_in? %>
      <div class="edit-user-btn">
        <%= link_to "Edit Profile", edit_user_path %>
      </div>
    <% elsif !myself?(@user.id) && !friend?(@user.id) %>
      <div class="edit-user-btn">
        <%= link_to "Add Friend", friend_request_path(request_id: @user.id), method: :post %>
      </div>
    <% elsif !myself?(@user.id) && friend?(@user.id) %>
      <div class="edit-user-btn">
        <%= link_to "Remove Friend", remove_friend_path(request_id: @user.id), method: :post %>
      </div>
    <% end %>
  </div>
  <div class="user-heading-right">
    <h2 class="user-bio-label">About <%= @user.name %>: </h2>
    <p class="user-bio"><%= @user.bio %></p>
  </div>
</div>

<div class="user-content-grid">
  <div class="user-events">
    <div class="user-new-event-btn"><%= link_to "Create Event", new_event_path %></div>
    <h2 class="user-events-heading">What I'm Attending</h2>
    <% if @user.events.count > 0 %>
        <% @user.events.each do |event| %>
          <div class="event-card">
          <div class="event-card-content">
            <div class="event-card-title">
              <p class="event-card-title-item item-link"><%= link_to event.name, event_path(event) %></p>
              <p class="event-card-title-item"><%= event.location %></p>
              <p class="event-card-title-item"><%=event.date.strftime("%m/%d/%y") %></p>
              <p class="event-card-title-item"><%= event.time.strftime("%I:%M %p") %></p>
            </div>
            <div class="event-card-desc">
              <p class="card-desc">Event Description:</p>
              <p class="card-text"><%= event.description %></p>
            </div>
            <div class="event-card-footer">
              <%= button_to "Leave Event", leave_event_path, method: "post", params:{event_id: event.id} %>
            </div>
          </div>
          </div>
        <% end %>
      <div class="user-all-event-btn"><%= link_to "All Events", events_path %></div>
    <% else %>
        <p>You are currently not attending any events, <%= link_to "click here to join events.",  events_path %></p>
    <% end %>
  </div>
  <div class="user-friends">
    <p class="user-friends-heading">Friends</p>
    <% if @friends.count > 0 %>
      <ul>
        <% @friends.each do |friend| %>
          <li class="user-friend"><%= link_to friend.name, user_path(friend) %></li>
          <%= button_to "Remove Friend", remove_friend_path, method: "post", params: {request_id: friend.id} %>
        <% end %>
      </ul>
    <% else %>
      <p>No friends</p>
    <% end %>
  </div>
  
</div>

<br>


<br>
<% if !myself?(@user.id) && !friend?(@user.id) %>
  <%= button_to "Add Friend", friend_request_path, method: "post", params: {request_id: @user.id} %>
<% elsif !myself?(@user.id) && friend?(@user.id) %>
  <%= button_to "Remove Friend", remove_friend_path, method: "post", params: {request_id: @user.id} %>
<% elsif current_user.requested_friends.count > 0 %>
  <h4>Pending Friend Request</h4>
  <% current_user.requested_friends.each do |friend| %>
      <%= link_to friend.name, user_path(friend) %>
      <%= button_to "Accept", accept_request_path, method: "post", params: {request_id: friend.id} %>
      <%= button_to "Decline", decline_request_path, method: "post", params: {request_id: friend.id} %>
  <% end %>
<% end %>

